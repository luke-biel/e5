[package]
name = "taplo"
description = "TOML toolkit with LSP, formatter, and validator"
homepage = "https://taplo.tamasfe.dev/"
verify_binary = "taplo"

[install.macos]
tap = "tamasfe/taplo"
package_name = "taplo"

[install.homebrew]
tap = "tamasfe/taplo"
package_name = "taplo"

[install.arch]
package_name = "taplo-cli"

[install.pacman]
package_name = "taplo-cli"

# Cargo is the primary installation method for most systems
[install.cargo]
package_name = "taplo-cli"
features = ["lsp"]

# NPM alternative
[install.npm]
package_name = "@taplo/cli"
global = true

# Script fallback
[install.script]
script = """
set -e
VERSION="0.9.3"
ARCH=$(uname -m)
OS=$(uname -s | tr '[:upper:]' '[:lower:]')

case "$ARCH" in
    x86_64) TAPLO_ARCH="x86_64" ;;
    aarch64|arm64) TAPLO_ARCH="aarch64" ;;
    *) echo "Unsupported architecture: $ARCH"; exit 1 ;;
esac

case "$OS" in
    linux) TAPLO_OS="linux" ;;
    darwin) TAPLO_OS="darwin" ;;
    *) echo "Unsupported OS: $OS"; exit 1 ;;
esac

TARBALL="taplo-full-${TAPLO_OS}-${TAPLO_ARCH}.gz"
curl -LO "https://github.com/tamasfe/taplo/releases/download/${VERSION}/${TARBALL}"
gunzip -f "${TARBALL}"
chmod +x "taplo-full-${TAPLO_OS}-${TAPLO_ARCH}"
mkdir -p "$HOME/.local/bin"
mv "taplo-full-${TAPLO_OS}-${TAPLO_ARCH}" "$HOME/.local/bin/taplo"
echo "Installed taplo to ~/.local/bin/"
"""
